<?php

class Entity_Post_Adapter_Test extends Wordlift_Unit_Test_Case {

	public function setUp() {
		parent::setUp(); // TODO: Change the autogenerated stub
		global $wp_filter;
		$wp_filter = array();
		// Reset all filters.
		run_wordlift();
	}


	public function test_sub_entities_should_not_be_created_in_analysis() {

		$post_content     = <<<EOF
<!-- wp:paragraph -->
<p><em><span id="urn:enhancement-20" class="textannotation">Reboot</span> and select proper <span id="urn:enhancement-32" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> device</em> message can be quite problematic since it will prevent you from starting Windows. There are numerous causes for this issue, but the most likely are your settings.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>If you <span id="urn:enhancement-43" class="textannotation">encounter</span> this message on your <span id="urn:enhancement-16" class="textannotation">PC</span>, donâ€™t be alarmed. In this guide, we have a couple of solutions that will surely help you fix this issue and get your <span id="urn:enhancement-17" class="textannotation">PC</span> to <span id="urn:enhancement-33" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting"><span id="urn:enhancement-28" class="textannotation">boot</span></span> again properly.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator"/>
<!-- /wp:separator -->

<!-- wp:heading -->
<h2>How do I fix reboot and select proper boot device?</h2>
<!-- /wp:heading -->

<!-- wp:heading {"level":3} -->
<h3>1. Enable or disable Legacy Boot (only UEFI computers)</h3>
<!-- /wp:heading -->

<!-- wp:image {"align":"center","id":620304,"sizeSlug":"large","linkDestination":"none"} -->
<div class="wp-block-image"><figure class="aligncenter size-large"><img src="https://cdn.windowsreport.com/wp-content/uploads/2021/02/legacy-boot.jpg" alt="legacy boot reboot and select proper boot device" class="wp-image-620304"/></figure></div>
<!-- /wp:image -->

<!-- wp:list {"ordered":true} -->
<ol><li>Restart the computer and enter <strong>UEFI</strong> settings.&nbsp;</li><li>Search the <strong>Legacy Boot</strong> option.</li><li>Enable or disable <strong>Legacy Boot</strong>. </li><li>Save changes.</li><li>Restart computer.</li><li>Verify if the problem disappeared.</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p><em><span id="urn:enhancement-21" class="textannotation">Reboot</span> and select proper <span id="urn:enhancement-34" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting"><span id="urn:enhancement-29" class="textannotation">boot</span></span> device </em>message can appear on a <span id="urn:enhancement-9" class="textannotation">new</span> <span id="urn:enhancement-18" class="textannotation">PC</span>, and if that happens, be sure to <span id="urn:enhancement-45" class="textannotation">check</span> the <span id="urn:enhancement-38" class="textannotation">UEFI</span> settings.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":3} -->
<h3> 2. Verify computer boot order</h3>
<!-- /wp:heading -->

<!-- wp:list {"ordered":true} -->
<ol><li>Restart the computer and enter <strong>BIOS</strong>.</li><li>Choose the <strong>Boot</strong> section.</li><li>Verify the order of boot devices.</li><li>Set <strong>Hard Disk Drive (HDD)</strong> as the primary boot source. <a href="https://windowsreport.com/wp-content/uploads/2021/01/Reboot-and-select-proper-boot-device-S2-P4.png"><img class="aligncenter wp-image-594955 size-full" src="https://windowsreport.com/wp-content/uploads/2021/01/Reboot-and-select-proper-boot-device-S2-P4.png" alt="Fix error reboot and select proper boot device" width="646" height="493"></a></li><li>Press <strong>F10</strong> to <em>Save and Exit</em>.</li><li>Click <strong>Yes</strong> to confirm changes.</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>If you ever encounter <em>Reboot and select proper <span id="urn:enhancement-35" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> device or insert <span id="urn:enhancement-36" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> media in selected <span id="urn:enhancement-37" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> device and press a key</em>,<em> </em>usually the problem is your <span id="urn:enhancement-38" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> order, so be sure to adjust it accordingly.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":3} -->
<h3>3. Use Startup Repair and diskpart</h3>
<!-- /wp:heading -->

<!-- wp:image {"align":"center","id":620397,"sizeSlug":"large","linkDestination":"none"} -->
<div class="wp-block-image"><figure class="aligncenter size-large"><img src="https://cdn.windowsreport.com/wp-content/uploads/2021/02/startup-repair.jpg" alt="startup repair reboot and select proper boot device" class="wp-image-620397"/></figure></div>
<!-- /wp:image -->

<!-- wp:list {"ordered":true} -->
<ol><li>Insert a <strong>Windows installation disk</strong> or <strong>USB</strong>.</li><li>Launch <strong>BIOS</strong> and navigate to <em>Boot</em> section.</li><li>Select <strong>CD-Rom Drive</strong> as the primary boot source. </li><li>Press F10 to <strong>Save and Exit</strong>.</li><li>Select your preferences for language, time zone and keyboard layout.</li><li>Click on <strong>Next</strong> and then <em>Install Now</em>.</li><li>Select <strong>Repair your computer</strong> and enter <em>Startup Options</em>. </li><li>Click on <strong>Troubleshoot</strong> and then choose <em>Automatic Repair</em>.</li><li>Choose your Operating System and select the <strong>Administrator</strong> account.</li><li>Type in your account password and click on <strong>Continue</strong>.</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>This is the first part of the solution called Startup Repair, and at the end, you must <span id="urn:enhancement-4" class="textannotation disambiguated wl-creative-work" itemid="http://data.windowsreport.com/windowsreport/post/dns_server_is_not_responding_on_windows_10_solved/MTg0Mzc0NjQ0ODQwMzEzODI1Mw">restart</span> the computer if you are prompted to. </p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Once the process has finished, you will be notified if problems were detected and if the <span id="urn:enhancement-40" class="textannotation">Startup Repair</span> has <span id="urn:enhancement-7" class="textannotation">fixed</span> them. The second part of this solution involves activating diskpart.</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>Go to <strong>Command Prompt</strong>.</li><li>Type in <code><strong>diskpart</strong></code></li><li>In diskpart type in <code><strong>select disk 0</strong></code></li><li>Select disk A for the section containing your Windows.</li><li>Type in <code><strong>list partition</strong></code></li><li>Type in <code>select <strong>partition 1</strong></code></li><li>Type in <code><strong>active</strong></code><br><a href="https://windowsreport.com/wp-content/uploads/2021/02/diskpart-parition-active.png"><img width="612" height="263" class="aligncenter size-full wp-image-620401" src="https://windowsreport.com/wp-content/uploads/2021/02/diskpart-parition-active.png" alt=""></a></li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>After setting your partition to active, the Reboot and select proper <span id="urn:enhancement-39" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> device message with your SSD should be gone.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>Note:</strong> You might have to select different partition depending on the number of disks and partitions that you have on your PC.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":3} -->
<h3>4.&nbsp; Replace CMOS battery</h3>
<!-- /wp:heading -->

<!-- wp:image {"id":410443,"sizeSlug":"large","linkDestination":"media"} -->
<figure class="wp-block-image size-large"><a href="https://windowsreport.com/wp-content/uploads/2019/10/lithium_bios_battery.jpg"><img src="https://windowsreport.com/wp-content/uploads/2019/10/lithium_bios_battery.jpg" alt="reset bios password cmos battery" class="wp-image-410443"/></a></figure>
<!-- /wp:image -->

<!-- wp:list {"ordered":true} -->
<ol><li>Open your computer case.</li><li>Locate the CMOS battery on the motherboard. </li><li>Remove CMOS battery.</li><li>Press and hold the Power button for 10 seconds.</li><li>Insert the CMOS battery again. Alternatively, you can replace your battery with a new one.</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Your computer's motherboard contains a small circular cell that is the CMOS battery. By removing the battery, you'll reset your settings to the default and hopefully fix the Reboot and select proper <span id="urn:enhancement-40" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting">boot</span> device <span id="urn:enhancement-14" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/error_messages">error</span>.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator"/>
<!-- /wp:separator -->

<!-- wp:heading {"level":3} -->
<h3>5. Reinstall Windows</h3>
<!-- /wp:heading -->

<!-- wp:image {"id":620633,"sizeSlug":"large","linkDestination":"none"} -->
<figure class="wp-block-image size-large"><img src="https://cdn.windowsreport.com/wp-content/uploads/2021/02/reinstall-windows.jpg" alt="" class="wp-image-620633"/></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>This is the ultimate solution available for you if the <span id="urn:enhancement-25" class="textannotation">reboot</span> and select proper <span id="urn:enhancement-41" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/booting"><span id="urn:enhancement-36" class="textannotation">boot</span></span> device <span id="urn:enhancement-15" class="textannotation disambiguated wl-thing" itemid="http://data.windowsreport.com/windowsreport/entity/error_messages">error</span> will not disappear after trying the previous ones.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>We have an in-depth guide on <a href="https://windowsreport.com/reinstall-windows-10/" target="_blank" rel="noreferrer noopener">how to reinstall Windows 10</a>, so be sure to check it out.</p>
<!-- /wp:paragraph -->

<!-- wp:separator -->
<hr class="wp-block-separator"/>
<!-- /wp:separator -->

<!-- wp:wordlift/classification {"entities":[{"annotations":{"urn:enhancement-14":{"start":1542,"end":1547,"text":"error"},"urn:enhancement-15":{"start":1642,"end":1647,"text":"error"}},"description":"foo","id":"http://data.windowsreport.com/windowsreport/entity/error_messages","label":"Error messages","mainType":"thing","description":"foo","occurrences":["urn:enhancement-14","urn:enhancement-15"],"sameAs":["http://dbpedia.org/page/Error_message","http://dbpedia.org/resource/Error","http://rdf.freebase.com/ns/m.0b8gc","https://www.wikidata.org/wiki/Q1332193"],"types":["thing"]},{"annotations":{"urn:enhancement-11":{"start":2541,"end":2545,"text":"BIOS"}},"description":"foo","id":"http://data.windowsreport.com/windowsreport/entity/bios","label":"BIOS","mainType":"thing","occurrences":["urn:enhancement-11"],"sameAs":["http://dbpedia.org/resource/BIOS","http://rdf.freebase.com/ns/m.01fj4","http://yago-knowledge.org/resource/BIOS"],"types":["thing"]},{"annotations":{"urn:enhancement-41":{"start":1630,"end":1634,"text":"boot"},"urn:enhancement-40":{"start":1530,"end":1534,"text":"boot"},"urn:enhancement-43":{"start":2198,"end":2202,"text":"boot"},"urn:enhancement-44":{"start":2360,"end":2364,"text":"boot"},"urn:enhancement-39":{"start":1137,"end":1141,"text":"boot"},"urn:enhancement-30":{"start":2485,"end":2493,"text":"bootable"},"urn:enhancement-36":{"start":606,"end":610,"text":"boot"},"urn:enhancement-35":{"start":584,"end":588,"text":"boot"},"urn:enhancement-38":{"start":700,"end":704,"text":"boot"},"urn:enhancement-37":{"start":629,"end":633,"text":"boot"},"urn:enhancement-32":{"start":29,"end":33,"text":"boot"},"urn:enhancement-31":{"start":2705,"end":2713,"text":"bootable"},"urn:enhancement-34":{"start":426,"end":430,"text":"boot"},"urn:enhancement-33":{"start":375,"end":379,"text":"boot"}},"description":"foo","id":"http://data.windowsreport.com/windowsreport/entity/booting","label":"Booting","mainType":"thing","occurrences":["urn:enhancement-32","urn:enhancement-33","urn:enhancement-34","urn:enhancement-35","urn:enhancement-36","urn:enhancement-37","urn:enhancement-38","urn:enhancement-39","urn:enhancement-40","urn:enhancement-41","urn:enhancement-43","urn:enhancement-44","urn:enhancement-30","urn:enhancement-31"],"sameAs":["http://dbpedia.org/resource/Booting","http://rdf.freebase.com/ns/m.0b6cy"],"types":["thing"]},{"annotations":{"urn:enhancement-4":{"start":837,"end":844,"text":"restart"}},"description":"foo","id":"http://data.windowsreport.com/windowsreport/post/dns_server_is_not_responding_on_windows_10_solved/MTg0Mzc0NjQ0ODQwMzEzODI1Mw","label":"Restart","mainType":"creative-work","occurrences":["urn:enhancement-4"],"sameAs":[],"types":["creative-work"]}]} /-->

<!-- wp:paragraph -->
<p>In most cases <em><span id="urn:enhancement-26" class="textannotation">Reboot</span> and select proper <span id="urn:enhancement-37" class="textannotation">boot</span> device</em> message appears due to your <span id="urn:enhancement-1" class="textannotation">BIOS settings</span>, but hopefully, you managed to fix this issue using our solutions.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Did you found a solution for this issue on your own? Share it with us in the comments section below!</p>
<!-- /wp:paragraph -->
EOF;
		$initial_entities = get_posts( array( 'post_type' => 'entity' ) );
		$this->assertCount( 0, $initial_entities, '0 entities should be present before post save' );
		// 2 entities will be created

		$post_id = $this->factory()->post->create( array(
			'post_content' => $post_content
		) );
		// Restart entity should not be created.
		$after_save_entities = get_posts( array( 'post_type' => 'entity' ) );
		$this->assertCount( 4, $after_save_entities, '4 entities should be present after post save' );


		wp_update_post(array(
			'ID' => $post_id,
			'post_status' => 'publish'
		));
		$this->assertCount( 4, get_posts( array( 'post_type' => 'entity' ) ), '4 entities should be present after post save' );
	}

}